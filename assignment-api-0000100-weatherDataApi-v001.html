<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>assignment-api-0000100-weatherdataapi-v001</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="assignment-api-0000100-weatherDataApi-v001_files/libs/clipboard/clipboard.min.js"></script>
<script src="assignment-api-0000100-weatherDataApi-v001_files/libs/quarto-html/quarto.js"></script>
<script src="assignment-api-0000100-weatherDataApi-v001_files/libs/quarto-html/popper.min.js"></script>
<script src="assignment-api-0000100-weatherDataApi-v001_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assignment-api-0000100-weatherDataApi-v001_files/libs/quarto-html/anchor.min.js"></script>
<link href="assignment-api-0000100-weatherDataApi-v001_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assignment-api-0000100-weatherDataApi-v001_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assignment-api-0000100-weatherDataApi-v001_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assignment-api-0000100-weatherDataApi-v001_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assignment-api-0000100-weatherDataApi-v001_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content page-columns page-full" id="quarto-document-content">




<section id="assignment---weather-api" class="level1 page-columns page-full">
<h1><yrchapternumber>18. </yrchapternumber> assignment - weather API</h1>
<style>
h4 { font-weight: bold; font-size: 1.2em; }
</style>
<p>The United States National Weather Service maintains a free API that returns weather information for specific latitudes and longitudes. For this assignment you will call the API and store the returned info in CSV files. There are two different API endpoints that will be needed for this assignment.</p>
<section id="the-weather-api" class="level2">
<h2 class="anchored" data-anchor-id="the-weather-api">The Weather API</h2>
<p>All URLs used to call the weather api start with <em>https://api.weather.gov/</em>. This is known as the “base URL” for the API.</p>
<p>The following describes how to use the weather API.</p>
<section id="httpsapi.weather.govpointslatitudelongitude" class="level3">
<h3 class="anchored" data-anchor-id="httpsapi.weather.govpointslatitudelongitude">https://api.weather.gov/points/{latitude},{longitude}</h3>
<p>The first “endpoint” we will use has the following format:</p>
<blockquote class="blockquote">
<p>https://api.weather.gov/points/{latitude},{longitude}</p>
</blockquote>
<p>where {latitude} and {longitude} are replaced with specific numeric values for latitude and longitude. For example, the following URL returns data for info about latitude 38.8894 and longitude -77.0352 <em>(make sure to notice the comma “,” that appears between the latitude</em> <em>and longitude numbers in the URL)</em> To make a similar call for other locations, simply replace the values with the appropriate latitude,longitude numbers.</p>
<blockquote class="blockquote">
<p>https://api.weather.gov/points/38.8894,-77.0352</p>
</blockquote>
<p>This “API call” doesn’t return the actual weather data. Rather, the JSON it returns includes references to other API URLs that can be used to get the actual weather data (see below). Specifically, the URL that we will be interested in is identified in the “forecastHourly” entry in the JSON. Below is an outline of the JSON that is returned from this API call. We omitted most of the data so that we can clearly highlight where the “forecastHourly” URL is in the JSON.</p>
<p>Click <a href="">here</a> to see the full JSON as it was returned from the API.</p>
<div class="sourceCode" id="cb1" style="font-size: 0.75em;"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">(Note</span> <span class="er">-</span> <span class="er">this</span> <span class="er">is</span> <span class="er">a</span> <span class="er">comment.</span> <span class="er">It</span> <span class="er">starts</span> <span class="er">with</span> <span class="er">//</span> <span class="er">Classic</span> <span class="er">JSON</span> <span class="er">does</span> <span class="er">not</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">allow</span> <span class="er">for</span> <span class="er">comments,</span> <span class="er">but</span> <span class="er">JSONC</span> <span class="er">(i.e.</span> <span class="er">JSON</span> <span class="er">with</span> <span class="er">Comments)</span> <span class="er">is</span> <span class="er">recognized</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">by</span> <span class="er">some</span> <span class="er">JSON</span> <span class="er">parsers.)</span> <span class="er">The</span> <span class="er">actual</span> <span class="er">API</span> <span class="er">does</span> <span class="er">not</span> <span class="er">include</span> <span class="er">comments</span> <span class="er">in</span> <span class="er">the</span> <span class="er">JSON</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">that</span> <span class="er">is</span> <span class="er">returned.</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"@context"</span><span class="fu">:</span><span class="ot">[</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"id"</span><span class="fu">:</span><span class="st">"https://api.weather.gov/points/38.8894,-77.0352"</span><span class="fu">,</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"type"</span><span class="fu">:</span><span class="st">"Feature"</span><span class="fu">,</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"geometry"</span><span class="fu">:{</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"properties"</span><span class="fu">:{</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">THIS</span> <span class="er">IS</span> <span class="er">THE</span> <span class="er">LINE</span> <span class="er">WE</span> <span class="er">ARE</span> <span class="er">INTERESTED</span> <span class="er">IN</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"forecastHourly"</span><span class="fu">:</span><span class="st">"https://api.weather.gov/gridpoints/LWX/97,71/forecast/hourly"</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="getting-the-hourly-forecasts" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-hourly-forecasts">getting the hourly forecasts</h3>
<p>The “forecastHourly” URL is obtained from the API call described in the previous section (see above). That JSON included the following line. It is this URL that we use to get the actual hour by hour weather forecast data.</p>
<blockquote class="blockquote">
<p>“forecastHourly”:“https://api.weather.gov/gridpoints/LWX/97,71/forecast/hourly”,</p>
</blockquote>
<p>Among other data, the JSON returned by this URL includes an array of time “periods”. Each period describes the forecast for a single hour of time in the specified location. For this specific URL there are 156 such periods in the data (the exact number of periods may change each time you visit this URL). Below we show an example of the first 2 periods from a specific call to this API. We removed much of the other data from the JSON shown below. <em>(NOTE that the forecast data could potentially change every time you call the API)</em></p>
<div class="sourceCode" id="cb2" style="font-size: 0.75em;"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"@context"</span><span class="fu">:</span><span class="ot">[</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"type"</span><span class="fu">:</span><span class="st">"Feature"</span><span class="fu">,</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"geometry"</span><span class="fu">:{</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"properties"</span><span class="fu">:{</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"units"</span><span class="fu">:</span><span class="st">"us"</span><span class="fu">,</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"forecastGenerator"</span><span class="fu">:</span><span class="st">"HourlyForecastGenerator"</span><span class="fu">,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"generatedAt"</span><span class="fu">:</span><span class="st">"2025-02-12T17:34:21+00:00"</span><span class="fu">,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"updateTime"</span><span class="fu">:</span><span class="st">"2025-02-12T17:30:41+00:00"</span><span class="fu">,</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"validTimes"</span><span class="fu">:</span><span class="st">"2025-02-12T11:00:00+00:00/P7DT14H"</span><span class="fu">,</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"elevation"</span><span class="fu">:{</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="er">//</span> <span class="er">SOME</span> <span class="er">STUFF</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>     <span class="fu">},</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"periods"</span><span class="fu">:</span><span class="ot">[</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"number"</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"name"</span><span class="fu">:</span><span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"startTime"</span><span class="fu">:</span><span class="st">"2025-02-12T12:00:00-05:00"</span><span class="fu">,</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"endTime"</span><span class="fu">:</span><span class="st">"2025-02-12T13:00:00-05:00"</span><span class="fu">,</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"isDaytime"</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"temperature"</span><span class="fu">:</span><span class="dv">34</span><span class="fu">,</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"temperatureUnit"</span><span class="fu">:</span><span class="st">"F"</span><span class="fu">,</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"temperatureTrend"</span><span class="fu">:</span><span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"probabilityOfPrecipitation"</span><span class="fu">:{</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"unitCode"</span><span class="fu">:</span><span class="st">"wmoUnit:percent"</span><span class="fu">,</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"value"</span><span class="fu">:</span><span class="dv">12</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"dewpoint"</span><span class="fu">:{</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"unitCode"</span><span class="fu">:</span><span class="st">"wmoUnit:degC"</span><span class="fu">,</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"value"</span><span class="fu">:</span><span class="dv">-0</span><span class="er">.</span><span class="dv">5555555555555556</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"relativeHumidity"</span><span class="fu">:{</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"unitCode"</span><span class="fu">:</span><span class="st">"wmoUnit:percent"</span><span class="fu">,</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"value"</span><span class="fu">:</span><span class="dv">89</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"windSpeed"</span><span class="fu">:</span><span class="st">"6 mph"</span><span class="fu">,</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"windDirection"</span><span class="fu">:</span><span class="st">"E"</span><span class="fu">,</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"icon"</span><span class="fu">:</span><span class="st">"https://api.weather.gov/icons/land/day/ovc?size=small"</span><span class="fu">,</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"shortForecast"</span><span class="fu">:</span><span class="st">"Cloudy"</span><span class="fu">,</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"detailedForecast"</span><span class="fu">:</span><span class="st">""</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"number"</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"name"</span><span class="fu">:</span><span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"startTime"</span><span class="fu">:</span><span class="st">"2025-02-12T13:00:00-05:00"</span><span class="fu">,</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"endTime"</span><span class="fu">:</span><span class="st">"2025-02-12T14:00:00-05:00"</span><span class="fu">,</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"isDaytime"</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"temperature"</span><span class="fu">:</span><span class="dv">34</span><span class="fu">,</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"temperatureUnit"</span><span class="fu">:</span><span class="st">"F"</span><span class="fu">,</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"temperatureTrend"</span><span class="fu">:</span><span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"probabilityOfPrecipitation"</span><span class="fu">:{</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"unitCode"</span><span class="fu">:</span><span class="st">"wmoUnit:percent"</span><span class="fu">,</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"value"</span><span class="fu">:</span><span class="dv">13</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"dewpoint"</span><span class="fu">:{</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"unitCode"</span><span class="fu">:</span><span class="st">"wmoUnit:degC"</span><span class="fu">,</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"value"</span><span class="fu">:</span><span class="dv">-0</span><span class="er">.</span><span class="dv">5555555555555556</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"relativeHumidity"</span><span class="fu">:{</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"unitCode"</span><span class="fu">:</span><span class="st">"wmoUnit:percent"</span><span class="fu">,</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"value"</span><span class="fu">:</span><span class="dv">89</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"windSpeed"</span><span class="fu">:</span><span class="st">"6 mph"</span><span class="fu">,</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"windDirection"</span><span class="fu">:</span><span class="st">"E"</span><span class="fu">,</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"icon"</span><span class="fu">:</span><span class="st">"https://api.weather.gov/icons/land/day/ovc?size=small"</span><span class="fu">,</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"shortForecast"</span><span class="fu">:</span><span class="st">"Cloudy"</span><span class="fu">,</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"detailedForecast"</span><span class="fu">:</span><span class="st">""</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>      <span class="er">//</span> <span class="er">THE</span> <span class="er">FIRST</span> <span class="dv">2</span> <span class="er">PERIODS</span> <span class="er">ARE</span> <span class="er">SHOWN</span> <span class="er">ABOVE.</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>      <span class="er">//</span> <span class="er">THE</span> <span class="er">API</span> <span class="er">CALL</span> <span class="er">RETURNED</span> <span class="dv">156</span> <span class="er">PERIODS.</span> </span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>      <span class="er">//</span> <span class="er">THE</span> <span class="er">REMAINDER</span> <span class="er">OF</span> <span class="er">THE</span> <span class="er">PERIODS</span> <span class="er">WERE</span> <span class="er">REMOVED</span> <span class="er">FOR</span> <span class="er">BREVITY.</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="more-info-about-the-weather-api" class="level3">
<h3 class="anchored" data-anchor-id="more-info-about-the-weather-api">More info about the weather API</h3>
<p>The info above should cover all that you need for this assignment. However, if you want to know more about the API see the following URLs.</p>
<p><strong>How to use the API</strong></p>
<ul>
<li><a href="https://weather-gov.github.io/api/general-faqs" class="uri">https://weather-gov.github.io/api/general-faqs</a></li>
</ul>
<p><strong>Other information about the API</strong></p>
<ul>
<li><p><a href="https://www.weather.gov/documentation/services-web-api" class="uri">https://www.weather.gov/documentation/services-web-api</a></p></li>
<li><p><a href="https://weather-gov.github.io/api/" class="uri">https://weather-gov.github.io/api/</a></p></li>
</ul>
</section>
</section>
<section id="what-you-need-to-do" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-you-need-to-do">What you need to do</h2>
<section id="use-of-ai" class="level3">
<h3 class="anchored" data-anchor-id="use-of-ai">Use of AI</h3>
<p>You MAY use AI to help you with this. However, you MUST UNDERSTAND all the code that you submit. If you don’t understand the code, don’t submit it.</p>
<p>You may only use Base R, and the packages that we have learned about in class. This includes the following packages:</p>
<ul>
<li>tibble</li>
<li>magrittr</li>
<li>fs</li>
<li>jsonlite</li>
<li>stringr</li>
</ul>
<p>You should inform the AI of these instructions so that it knows not to use functions from other packages. However, keep in mind that even if you do tell the AI to only use functions from these packages, it might use other packages anyway. Ultimately, you are responsible for reviewing the code and ensuring that it adheres to these directions.</p>
<p>Note that we did not cover all the functions in these packages. Nevertheless, you MAY use functions that we didn’t cover from these packages, but you must understand the code before submitting it (research on your own any functions that we didn’t cover in class).</p>
<p>You MUST include a copy of all of your conversations with the AI in your submission. (You may have multiple conversations with the AI). Use the yrWebSnap chrome extension to take a snapshot of the conversations with the AI.</p>
<p>You may be tempted to propmt the AI with a complete copy of the instructions in this file. That is fine. You can try that. However, sometimes you have better succes with an AI if you keep you focus on one particular part of the problem at a time. Experiment and see what works. Write up your experiences about what worked and what didn’t in the Quarto file you submit.</p>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">summary</h3>
<p>This section summarizes what you need to do. The next section goes into more detail about each step.</p>
<ol type="1">
<li><p>Create the following R functions</p>
<ul>
<li><p><strong>getForecastDf()</strong> -</p>
<p>Create an R function that calls the API to get the weather forecasts for a specific latitude and longitude. The latitude and longitude should be passed to this function as arguments. The function should return a dataframe<br>
that contains the weather data. (see next section for details)</p></li>
<li><p><strong>function createForecastFiles()</strong> - Create a second R function that calls the first function in a loop. Each time the first function is called the data that is returned should be saved in a new csv file. All of the CSV files should be placed in the same folder<br>
(see next section for details)</p></li>
<li><p><strong>combineCsvFiles()</strong> - Create a third R function that takes an entire folder of these csv files and returns a single dataframe that contains all of the rows from all of the csv files.<br>
(see next section for details)</p></li>
</ul></li>
<li><p>Writeup your results in a Quarto document.<br>
(see next section for details)</p></li>
</ol>
</section>
<section id="detailed-instructions" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="detailed-instructions">detailed instructions</h3>
<section id="function-getforecastdf" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="function-getforecastdf">function getForecastDf()</h4>
<p>Create the following function. See below for an explanation of each of the arguments. Below is a list of what the function needs to do.</p>
<pre><code>getForecastDf = function(latitude , longitude){
  # your code goes here
}</code></pre>
<section id="a-check-all-arguments" class="level5">
<h5 class="anchored" data-anchor-id="a-check-all-arguments">(a) Check all arguments …</h5>
<p>Your function should check that the arguments adhere to the following rules. If they don’t, the function should stop with an appropriate error message - i.e.&nbsp;call stop( SOME_ERROR_MESSAGE )</p>
</section>
<section id="b-check-all-arguments" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="b-check-all-arguments">(b) Check all arguments …</h5>
<p>This function should return a non-nested dataframe (i.e.&nbsp;a “normal” dataframe in which each entry is a single number, TRUE/FALSE, character value or NA). The dataframe should include all of the data from each period from the hourly weather forecast as shown in the image below. There should be one row in the dataframe for each time period from the JSON.</p>
<p>In addition, the first 3 columns of the dataframe should include the following information. These extra columns will have the exact same data for each row in the dataframe.</p>
<ul>
<li><p>latitude - ie. the latitude</p></li>
<li><p>longitude - ie. the longitude</p></li>
<li><p>apiCallTime - ie. the date and time that the API was called which included the info in the dataframe. The date/time/timezone should be formatted in ISO 8601 format (see the appendix at the bottom of this file). You can get this info using the following R code:</p>
<p><code>apiCallTime = format(Sys.time(), "%Y-%m-%dT%H:%M:%S-%z")</code></p></li>
</ul>
<p>Below is an image of an example of the first few rows of a dataframe returned from this function.</p>
<!--
:::{.column-body-outset}
-->
<div class="column-screen">
<p><img src="forecastDfRows-v002.png" class="img-fluid"></p>
</div>
</section>
</section>
<section id="function-createforecastfiles" class="level4">
<h4 class="anchored" data-anchor-id="function-createforecastfiles">function createForecastFiles()</h4>
<p>Create the following function. See below for an explanation of each of the arguments. Below is a list of what the function needs to do.</p>
<pre><code>createForecastFiles = function(latitude , 
                               longitude , 
                               sleepSeconds, 
                               outputFolder = "." , 
                               createFolder = FALSE ,
                               numberOfApiCalls = Inf){
  # your code goes here
}</code></pre>
<section id="a-check-all-arguments-1" class="level5">
<h5 class="anchored" data-anchor-id="a-check-all-arguments-1">(a) Check all arguments …</h5>
<p>Your function should check that the arguments adhere to the following rules. If they don’t, the function should stop with an appropriate error message - i.e.&nbsp;call stop( SOME_ERROR_MESSAGE )</p>
<ul>
<li><p>latitude, longitude, sleepSeconds, numberOfApiCalls numeric vectors whose length is 1.</p></li>
<li><p>createFolder should be a logical vector whose length is 1.</p></li>
</ul>
</section>
<section id="b-possibly-create-the-output-folder" class="level5">
<h5 class="anchored" data-anchor-id="b-possibly-create-the-output-folder">(b) possibly create the output folder</h5>
<p>If the outputFolder doesn’t exist then</p>
<ul>
<li><p>If the <code>createFolder</code> argument is FALSE then the function should stop with an appropriate error message - i.e.&nbsp;call the function, stop(ERROR_MESSAGE).</p></li>
<li><p>If the <code>createFolder</code> argument is TRUE then the function should create the folder To do this, use the dir_create function in the fs package.</p></li>
</ul>
</section>
<section id="c-call-the-getforecastdf-in-a-loop" class="level5">
<h5 class="anchored" data-anchor-id="c-call-the-getforecastdf-in-a-loop">(c) call the getForecastDf in a loop</h5>
<p>The <code>createForecastFiles</code> function should continuously call the function <code>getForecastDf</code> in a loop. The loop should go around as many times as is specified in <code>numberOfApiCalls</code> argument. As part of this loop the function should call <code>Sys.sleep(sleepSeconds)</code> to ensure that there are at least <code>sleepSeconds</code> seconds between every call to the API.</p>
</section>
<section id="d-save-each-dataframe-in-a-separate-.csv-file" class="level5">
<h5 class="anchored" data-anchor-id="d-save-each-dataframe-in-a-separate-.csv-file">(d) save each dataframe in a separate .csv file</h5>
<p>Each time getForecastsDf() is called, the dataframe that is returned should be saved in a separate csv file. The name of each csv file should contain the timestamp that the API was called in the following format:</p>
<blockquote class="blockquote">
<p>hourlyData_lat_long_YYYY-MM-DDTHH-MM-SS-TZ.csv</p>
</blockquote>
<p><em>NOTES</em></p>
<ul>
<li><p>hourlyData is always the first part of the filename</p></li>
<li><p>lat is the latitude (e.g.&nbsp;38.8894)</p></li>
<li><p>long in the longitude (e.g.&nbsp;-77.0352)</p></li>
<li><p>YYYY-MM-DD-HH-MM-SS-TZ is the date/time/timezone for when the API was called. This should be the same date/time/timezone that is returned in the first column of the dataframe - see (1) above. However, note that the colons (:) from the date/time/timezone in dataframe should be changed to dashes (-) for the filename since filenames on both Mac and Windows may not contain colons (:). You can use the following code to make this change:<br>
<code>TIMESTAMP_WITHOUT_COLONS = gsub(':', '-', TIMESTAMP_WITH_COLONS)</code></p></li>
<li><p>The different parts of the filename described above are separated from each other with underscores ( _ ).</p></li>
</ul>
<p>For example - the filename for the the dataframe shown in the image in the previous section, should be:</p>
<blockquote class="blockquote">
<p>hourlyData_38.8894_-77.0352_2025-02-13T03-56-55-0500.csv</p>
</blockquote>
</section>
<section id="e-use-cat-to-display-info-as-the-function-is-running" class="level5">
<h5 class="anchored" data-anchor-id="e-use-cat-to-display-info-as-the-function-is-running">(e) Use cat to display info as the function is running</h5>
<p>This function could run for a long time. To make sure that the user knows that the function is running, the function should display a period (i.e.&nbsp;” .”) every 15 seconds or so. This alerts the user to the fact that the function is indeed working. You can accomplish this by using a loop with code similar to the following:</p>
<pre><code>while( SOME_CONDITION ){
  Sys.sleep( 15 )
  cat(" .")
}</code></pre>
<p>In addition, each time the API is called or a CSV file is written, your code should display a message to the user with the date/time and an appropriate message, for example:</p>
<pre><code>...........................................................................
...........................................
2025-02-17T13:00:01-05:00  Called API - https://api.weather.gov/gridpoints/LWX/97,71/forecast/hourly
2025-02-17T13:00:03-05:00  Created file: hourlyData_38.8894_-77.0352_2025-02-17T13:00:03-05:00.csv
...........................................................................
...........................................
2025-02-17T14:00:01-05:00  Called API - https://api.weather.gov/gridpoints/LWX/97,71/forecast/hourly
2025-02-17T14:00:03-05:00  Created file: hourlyData_38.8894_-77.0352_2025-02-17T14:00:03-05:00.csv</code></pre>
</section>
<section id="f-return-a-vector-with-filenames-that-were-created" class="level5">
<h5 class="anchored" data-anchor-id="f-return-a-vector-with-filenames-that-were-created">(f) return a vector with filenames that were created</h5>
<ul>
<li>When the function is finished, it should return a vector that contains the names of all of the files that were created. (Note that if )</li>
</ul>
</section>
</section>
<section id="function-combinecsvfiles-folder.-pattern..ccssvv" class="level4">
<h4 class="anchored" data-anchor-id="function-combinecsvfiles-folder.-pattern..ccssvv">function combineCsvFiles( folder=“.”, pattern=“.*\.[cC][sS][vV]“)</h4>
<p>This function should return a single dataframe. The dataframe should contain the rows from all of the csv files in the specified <code>folder</code> whose names match the specified regular expression <code>pattern</code>.</p>
<p>HINT: Use the Base-R dir function (AKA list.files) with the pattern argument.</p>
<!--

This video shows how to access the API via Tidyverse packages. For this
assignment you are only to use the packages that we covered so far in class. 
THis includes - anything from Base R, tibbles, magrittr pipes.

https://www.youtube.com/watch?v=hmtE4QGIOuk&t=1609s

The following blog post is associated with that video:

-->
</section>
</section>
<section id="create-a-quarto-file" class="level3">
<h3 class="anchored" data-anchor-id="create-a-quarto-file">Create a Quarto file</h3>
<p>Include all of the following in the Quarto .qmd file:</p>
<ul>
<li><p>An brief description of the problem - include a link to this webpage.</p></li>
<li><p>Describe your experience using AI. (If you didn’t use AI at all, just say so). Describe a little about your experience - which AI tools you used - what worked - what didn’t work - did you need to debug the code yourself or did the AI debug the code for you - etc.</p>
<p>Include links to the yrWebSnips .html files that contain a copy of your AI conversations.</p></li>
<li><p>Your .R code file should include not only the funcitons but also examples of the functions being used. For example</p></li>
<li><p>Include links to your .R file(s) - e.g.&nbsp;&lt;myProgram.R&gt; - so that anyone viewing the Quarto html file in a browser can “download” your R file by clicking on the link.</p></li>
<li><p>Include the code from your .R file(s) in the Quarto by specifying the filename(s) in the code chunk as shown below. The <code>code-line-numbers: true</code> option displays line numbers next to the code.</p>
<pre><code>#| file: YOUR_FILENAME.R
#| code-line-numbers: true  </code></pre></li>
<li><p>Include R code (displayed in Quarto code chunks) that demonstrates your code working.</p>
<p>The code chunks should include the functions you wrote and examples of them working. When running the code, do <strong>NOT</strong> show entire dataframe(s). Rather just show the first 10 or so rows from each dataframe by using, for example, the function call <code>head(SOME_DATAFRAME, 10)</code>.</p></li>
</ul>
</section>
<section id="what-to-submit" class="level3">
<h3 class="anchored" data-anchor-id="what-to-submit">What to submit</h3>
<ul>
<li><p>Create a folder that contains all of the following:</p>
<ul>
<li>A copy of the .qmd file.</li>
<li>A copy of the rendered qmd file (ie. the .html file) as well as the folder that is created when you render the .qmd file.</li>
<li>A sample of at least 3 copies of the .csv files that are created when you run your code.</li>
<li>The .html files that contain the output from the yrWebSnip of your conversations with the AI</li>
</ul></li>
<li><p>Create a ZIP file of this folder and submit it</p></li>
</ul>
</section>
</section>
<section id="appendix---explanation-of-standard-datetimetimezone-format" class="level2">
<h2 class="anchored" data-anchor-id="appendix---explanation-of-standard-datetimetimezone-format">Appendix - Explanation of standard date/time/timezone format</h2>
<p>Different countries and locales have different standards for how to represent dates and times (e.g.&nbsp;month/day/year in USA and day/month/year in Europe). The following format has become well accepted in computing circles all over the world.</p>
<ul>
<li>YYYY-MM-DDTHH:MM:SS±HH:MM”</li>
</ul>
<p>For example <strong>2023-10-26T14:30:00-05:00</strong> represents October 26, 2023 at 2:30 PM with a 5-hour time zone offset (e.g., Eastern Standard Time).</p>
<p>Comments:</p>
<ul>
<li>“YYYY” is the 4 digit year</li>
<li>“MM” is the 2 digit month</li>
<li>“DD” is the 2 digit day of the month</li>
<li>“HH” is the 2 digit hour</li>
<li>“MM” is the 2 digit minute</li>
<li>“SS” is the 2 digit second</li>
<li>“±HH:MM” represents the time zone offset from UTC (Coordinated Universal Time). This incluedes a plus (+) or minus (-) sign followed by the hours and minutes offset from UTC.</li>
</ul>
<p>Additional comments:</p>
<ul>
<li>There are dashes (i.e.&nbsp;“-”) between different parts of the date</li>
<li>The “T” character separates the date from the time.</li>
<li>There are colons (i.e.&nbsp;“:”) between different parts of the time</li>
<li>If the time is in UTC, you can use a “Z” instead of a time zone offset.</li>
</ul>
<p>This format is described in the official <a href="https://www.ietf.org/rfc/rfc3339.txt">RFC3339</a> standard which in turn was derived from the <a href="https://fits.gsfc.nasa.gov/iso-time.html">ISO 8601</a> standard.</p>
<div style="font-size:.8em;font-style:italic;">
<p>It’s not necessary for this project, but if you’re interested and want to learn more about these standards see these links:</p>
<ul>
<li><p>What is an RFC? - videos</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=TtKKKUy4WU0">Short to the point (4 minutes)</a></li>
<li><a href="https://www.youtube.com/watch?v=8IXLpoN8Xj0">More info (10.5 minutes)</a></li>
</ul></li>
<li><p><a href="https://medium.easyread.co/understanding-about-rfc-3339-for-datetime-formatting-in-software-engineering-940aa5d5f68a">Understanding RFC3339</a></p></li>
<li><p><a href="https://www.ietf.org/rfc/rfc3339.txt">The actual RFC3339 (very technical) - https://www.ietf.org/rfc/rfc3339.txt</a></p></li>
<li><p><a href="https://stackoverflow.com/questions/522251/whats-the-difference-between-iso-8601-and-rfc-3339-date-formats">Difference between RFC3339 and ISO 8601</a></p></li>
<li><p><a href="https://ijmacd.github.io/rfc3339-iso8601/">Interesting graphic highlighting different date/time formats</a></p></li>
</ul>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>